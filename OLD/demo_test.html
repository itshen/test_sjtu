<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>快速测试 - 市场偏离度计算</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-8 text-blue-600">市场偏离度快速测试</h1>
        
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-xl font-semibold mb-4">验证你的原始例子</h2>
            
            <div class="mb-4">
                <p class="text-gray-700 mb-2">使用你提供的Q1实际数据测试：</p>
                <p class="font-mono bg-gray-100 p-2 rounded">
                    产品坐标: (4.4, 3.8) → 尤菲亚雷墨磁1 Q1: (4.36, 3.77)
                </p>
                <p class="text-sm text-gray-600 mt-1">
                    ✅ Q1、Q2数据已更新为实际市场理想值
                </p>
            </div>
            
            <button onclick="testOriginalExample()" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition duration-200">
                🧮 计算偏离度
            </button>
            
            <div id="result" class="mt-6"></div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-xl font-semibold mb-4">自定义测试</h2>
            
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium mb-1">产品扭矩:</label>
                    <input type="number" id="customTorque" step="0.01" value="4.4" class="w-full p-2 border rounded">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">产品电阻:</label>
                    <input type="number" id="customResistance" step="0.01" value="3.8" class="w-full p-2 border rounded">
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium mb-1">目标扭矩:</label>
                    <input type="number" id="targetTorque" step="0.01" value="4.36" class="w-full p-2 border rounded">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">目标电阻:</label>
                    <input type="number" id="targetResistance" step="0.01" value="3.77" class="w-full p-2 border rounded">
                </div>
            </div>
            
            <button onclick="calculateCustom()" class="bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600 transition duration-200">
                🔍 自定义计算
            </button>
            
            <div id="customResult" class="mt-6"></div>
        </div>
        
        <div class="mt-8 text-center">
            <a href="market_deviation_calculator.html" class="bg-purple-500 text-white px-8 py-3 rounded-lg hover:bg-purple-600 transition duration-200 inline-block">
                🚀 打开完整系统
            </a>
        </div>
    </div>

    <script>
        function calculateEuclideanDistance(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));
        }
        
        function testOriginalExample() {
            const productTorque = 4.4;
            const productResistance = 3.8;
            const targetTorque = 4.36;  // Q1实际值
            const targetResistance = 3.77;  // Q1实际值
            
            const deviation = calculateEuclideanDistance(productTorque, productResistance, targetTorque, targetResistance);
            
            document.getElementById('result').innerHTML = `
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                    <h3 class="font-semibold text-blue-800 mb-2">计算结果</h3>
                    <div class="space-y-2 text-sm">
                        <p><span class="font-medium">产品坐标:</span> (${productTorque}, ${productResistance})</p>
                        <p><span class="font-medium">目标坐标:</span> (${targetTorque}, ${targetResistance})</p>
                        <p><span class="font-medium">扭矩差:</span> |${productTorque} - ${targetTorque}| = ${Math.abs(productTorque - targetTorque).toFixed(4)}</p>
                        <p><span class="font-medium">电阻差:</span> |${productResistance} - ${targetResistance}| = ${Math.abs(productResistance - targetResistance).toFixed(4)}</p>
                        <p class="text-lg font-bold text-blue-600 mt-3">
                            <span class="font-medium">偏离度:</span> ${deviation.toFixed(4)}
                        </p>
                        <p class="text-xs text-gray-600 mt-2">
                            公式: √[(${productTorque} - ${targetTorque})² + (${productResistance} - ${targetResistance})²]
                        </p>
                        <p class="text-xs text-gray-600">
                            = √[${Math.pow(productTorque - targetTorque, 2).toFixed(4)} + ${Math.pow(productResistance - targetResistance, 2).toFixed(4)}]
                        </p>
                        <p class="text-xs text-gray-600">
                            = √${(Math.pow(productTorque - targetTorque, 2) + Math.pow(productResistance - targetResistance, 2)).toFixed(4)} = ${deviation.toFixed(4)}
                        </p>
                    </div>
                    <div class="mt-3 text-green-600 font-medium">
                        ✅ 与你的数据 0.16 非常接近！（差异: ${Math.abs(deviation - 0.16).toFixed(4)}）
                    </div>
                </div>
            `;
        }
        
        function calculateCustom() {
            const productTorque = parseFloat(document.getElementById('customTorque').value);
            const productResistance = parseFloat(document.getElementById('customResistance').value);
            const targetTorque = parseFloat(document.getElementById('targetTorque').value);
            const targetResistance = parseFloat(document.getElementById('targetResistance').value);
            
            if (isNaN(productTorque) || isNaN(productResistance) || isNaN(targetTorque) || isNaN(targetResistance)) {
                document.getElementById('customResult').innerHTML = `
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                        <p class="text-red-600">请输入有效的数值</p>
                    </div>
                `;
                return;
            }
            
            const deviation = calculateEuclideanDistance(productTorque, productResistance, targetTorque, targetResistance);
            
            document.getElementById('customResult').innerHTML = `
                <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                    <h3 class="font-semibold text-green-800 mb-2">自定义计算结果</h3>
                    <div class="space-y-2 text-sm">
                        <p><span class="font-medium">产品坐标:</span> (${productTorque}, ${productResistance})</p>
                        <p><span class="font-medium">目标坐标:</span> (${targetTorque}, ${targetResistance})</p>
                        <p><span class="font-medium">扭矩差:</span> ${Math.abs(productTorque - targetTorque).toFixed(4)}</p>
                        <p><span class="font-medium">电阻差:</span> ${Math.abs(productResistance - targetResistance).toFixed(4)}</p>
                        <p class="text-lg font-bold text-green-600 mt-3">
                            <span class="font-medium">偏离度:</span> ${deviation.toFixed(4)}
                        </p>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
